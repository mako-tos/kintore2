---

description: "機能実装のためのタスクリストテンプレート"
---

# タスク: [機能名]

**入力**: `/specs/[###-feature-name]/` からの設計文書
**前提条件**: plan.md（必須）, spec.md（ユーザーストーリーに必須）, research.md, data-model.md, contracts/

**テスト**: 以下の例にはテストタスクが含まれています。テストはオプションであり、機能仕様で明示的に要求された場合にのみ含めてください。

**構成**: タスクはユーザーストーリーごとにグループ化され、各ストーリーの独立した実装とテストを可能にします。

## 形式: `[ID] [P?] [Story] 説明`

- **[P]**: 並行実行可能（異なるファイル、依存関係なし）
- **[Story]**: このタスクが属するユーザーストーリー（例: US1, US2, US3）
- 説明には正確なファイルパスを含める

## パス規則

- **単一プロジェクト**: リポジトリルートに `src/`, `tests/`
- **Webアプリ**: `backend/src/`, `frontend/src/`
- **モバイル**: `api/src/`, `ios/src/` または `android/src/`
- 以下のパスは単一プロジェクトを想定 - plan.mdの構造に応じて調整

<!-- 
  ============================================================================
  重要: 以下のタスクは説明目的のサンプルタスクです。
  
  /speckit.tasks コマンドは、以下に基づいて実際のタスクに置き換える必要があります：
  - spec.mdからのユーザーストーリー（優先度P1, P2, P3...を含む）
  - plan.mdからの機能要件
  - data-model.mdからのエンティティ
  - contracts/からのエンドポイント
  
  タスクはユーザーストーリーごとに整理され、各ストーリーが以下を満たす必要があります：
  - 独立して実装可能
  - 独立してテスト可能
  - MVPの増分として提供可能
  
  これらのサンプルタスクは生成されるtasks.mdファイルに残さないでください。
  ============================================================================
-->

## フェーズ1: セットアップ（共有インフラ）

**目的**: プロジェクトの初期化と基本構造の構築

- [ ] T001 実装計画に従ってプロジェクト構造を作成
- [ ] T002 [言語]プロジェクトを[フレームワーク]の依存関係とともに初期化
- [ ] T003 [P] リントとフォーマットツールの設定

---

## フェーズ2: 基盤（ブロッキング前提条件）

**目的**: どのユーザーストーリーを実装する前にも完了しておかなければならない中核インフラ

**⚠️ 重要**: このフェーズが完了するまでユーザーストーリーの作業を開始できません

基盤タスクの例（プロジェクトに応じて調整）:

- [ ] T004 データベーススキーマとマイグレーションフレームワークのセットアップ
- [ ] T005 [P] 認証/認可フレームワークの実装
- [ ] T006 [P] APIルーティングとミドルウェア構造のセットアップ
- [ ] T007 すべてのストーリーが依存する基本モデル/エンティティの作成
- [ ] T008 エラー処理とロギングインフラの設定
- [ ] T009 環境設定管理のセットアップ

-- 基盤（憲法に基づく必須タスク） --
- [ ] T100 Supabaseプロジェクト作成と接続の確立（接続文字列、ロール、ポリシー設定）
- [ ] T101 マイグレーション用スキーマ定義とマイグレーション実行の自動化（例: pg-migrate等）
- [ ] T102 環境変数およびシークレット管理の設定（Netlify環境変数、ローテーション方針文書化）
- [ ] T103 Netlifyのプレビュー/ステージングデプロイ設定（PRごとのPreview）
- [ ] T104 RUM（実ユーザーモニタリング）導入とCIでのパフォーマンステスト設定
- [ ] T105 アクセシビリティ検査の自動化（色覚チェック、キーボード操作、フォント表示確認）
- [ ] T106 バックアップと復元手順の作成（自動バックアップ・復元テスト）
- [ ] T107 依存関係の脆弱性スキャン導入（Dependabot等/定期スキャン）
- [ ] T108 シークレット漏洩時の対応手順と緊急連絡フロー作成

**チェックポイント**: 基盤準備完了 - ユーザーストーリーの実装を並行して開始可能

---

## フェーズ3: ユーザーストーリー1 - [タイトル] (優先度: P1) 🎯 MVP

**目標**: [このストーリーが提供するものの簡単な説明]

**独立したテスト**: [このストーリーが独立して機能することを確認する方法]

### ユーザーストーリー1のテスト（オプション - テストが要求された場合のみ）⚠️

> **注意: これらのテストを最初に書き、実装前に必ず失敗することを確認**

- [ ] T010 [P] [US1] [エンドポイント]のコントラクトテスト（tests/contract/test_[name].py）
- [ ] T011 [P] [US1] [ユーザージャーニー]の統合テスト（tests/integration/test_[name].py）

### ユーザーストーリー1の実装

- [ ] T012 [P] [US1] [エンティティ1]モデルの作成（src/models/[entity1].py）
- [ ] T013 [P] [US1] [エンティティ2]モデルの作成（src/models/[entity2].py）
- [ ] T014 [US1] [サービス]の実装（src/services/[service].py）（T012, T013に依存）
- [ ] T015 [US1] [エンドポイント/機能]の実装（src/[location]/[file].py）
- [ ] T016 [US1] バリデーションとエラー処理の追加
- [ ] T017 [US1] ユーザーストーリー1の操作のロギング追加

**チェックポイント**: この時点で、ユーザーストーリー1は完全に機能し、独立してテスト可能

---

## フェーズ4: ユーザーストーリー2 - [タイトル] (優先度: P2)

**目標**: [このストーリーが提供するものの簡単な説明]

**独立したテスト**: [このストーリーが独立して機能することを確認する方法]

### ユーザーストーリー2のテスト（オプション - テストが要求された場合のみ）⚠️

- [ ] T018 [P] [US2] [エンドポイント]のコントラクトテスト（tests/contract/test_[name].py）
- [ ] T019 [P] [US2] [ユーザージャーニー]の統合テスト（tests/integration/test_[name].py）

### ユーザーストーリー2の実装

- [ ] T020 [P] [US2] [エンティティ]モデルの作成（src/models/[entity].py）
- [ ] T021 [US2] [サービス]の実装（src/services/[service].py）
- [ ] T022 [US2] [エンドポイント/機能]の実装（src/[location]/[file].py）
- [ ] T023 [US2] ユーザーストーリー1のコンポーネントとの統合（必要な場合）

**チェックポイント**: この時点で、ユーザーストーリー1と2の両方が独立して機能する

---

## フェーズ5: ユーザーストーリー3 - [タイトル] (優先度: P3)

**目標**: [このストーリーが提供するものの簡単な説明]

**独立したテスト**: [このストーリーが独立して機能することを確認する方法]

### ユーザーストーリー3のテスト（オプション - テストが要求された場合のみ）⚠️

- [ ] T024 [P] [US3] [エンドポイント]のコントラクトテスト（tests/contract/test_[name].py）
- [ ] T025 [P] [US3] [ユーザージャーニー]の統合テスト（tests/integration/test_[name].py）

### ユーザーストーリー3の実装

- [ ] T026 [P] [US3] [エンティティ]モデルの作成（src/models/[entity].py）
- [ ] T027 [US3] [サービス]の実装（src/services/[service].py）
- [ ] T028 [US3] [エンドポイント/機能]の実装（src/[location]/[file].py）

**チェックポイント**: すべてのユーザーストーリーが独立して機能する

---

[必要に応じて同じパターンでユーザーストーリーフェーズを追加]

---

## フェーズN: 洗練化と横断的な関心事

**目的**: 複数のユーザーストーリーに影響する改善

- [ ] TXXX [P] docs/内のドキュメント更新
- [ ] TXXX コードのクリーンアップとリファクタリング
- [ ] TXXX すべてのストーリーにわたるパフォーマンス最適化
- [ ] TXXX [P] 追加の単体テスト（要求された場合）をtests/unit/に追加
- [ ] TXXX セキュリティ強化
- [ ] TXXX quickstart.mdの検証実行

---

## 依存関係と実行順序

### フェーズの依存関係

- **セットアップ（フェーズ1）**: 依存関係なし - 即時開始可能
- **基盤（フェーズ2）**: セットアップ完了に依存 - すべてのユーザーストーリーをブロック
- **ユーザーストーリー（フェーズ3+）**: すべて基盤フェーズの完了に依存
  - ユーザーストーリーは並行して進行可能（スタッフが揃っている場合）
  - または優先順位順に順次実行（P1 → P2 → P3）
- **洗練化（最終フェーズ）**: 必要なすべてのユーザーストーリーの完了に依存

### ユーザーストーリーの依存関係

- **ユーザーストーリー1（P1）**: 基盤（フェーズ2）後に開始可能 - 他のストーリーへの依存なし
- **ユーザーストーリー2（P2）**: 基盤（フェーズ2）後に開始可能 - US1と統合する可能性があるが独立してテスト可能であるべき
- **ユーザーストーリー3（P3）**: 基盤（フェーズ2）後に開始可能 - US1/US2と統合する可能性があるが独立してテスト可能であるべき

### 各ユーザーストーリー内

- テスト（含まれる場合）は実装前に書かれ、失敗することを確認する必要がある
- モデルはサービスより前に
- サービスはエンドポイントより前に
- コア実装は統合より前に
- 次の優先度に移る前にストーリーを完了

### 並行実行の機会

- [P]マークのあるすべてのセットアップタスクは並行実行可能
- [P]マークのあるすべての基盤タスクは並行実行可能（フェーズ2内で）
- 基盤フェーズが完了すれば、すべてのユーザーストーリーは並行開始可能（チーム容量があれば）
- [P]マークのあるユーザーストーリーのすべてのテストは並行実行可能
- ストーリー内の[P]マークのあるモデルは並行実行可能
- 異なるユーザーストーリーは異なるチームメンバーによって並行して作業可能

---

## 並行実行例: ユーザーストーリー1

```bash
# ユーザーストーリー1のすべてのテストを一緒に開始（テストが要求された場合）：
タスク: "[エンドポイント]のコントラクトテスト（tests/contract/test_[name].py）"
タスク: "[ユーザージャーニー]の統合テスト（tests/integration/test_[name].py）"

# ユーザーストーリー1のすべてのモデルを一緒に開始：
タスク: "[エンティティ1]モデルの作成（src/models/[entity1].py）"
タスク: "[エンティティ2]モデルの作成（src/models/[entity2].py）"
```

---

## 実装戦略

### MVPファースト（ユーザーストーリー1のみ）

1. フェーズ1完了: セットアップ
2. フェーズ2完了: 基盤（重要 - すべてのストーリーをブロック）
3. フェーズ3完了: ユーザーストーリー1
4. **停止して検証**: ユーザーストーリー1を独立してテスト
5. 準備ができればデプロイ/デモ

### 段階的デリバリー

1. セットアップ + 基盤の完了 → 基盤準備完了
2. ユーザーストーリー1追加 → 独立テスト → デプロイ/デモ（MVP!）
3. ユーザーストーリー2追加 → 独立テスト → デプロイ/デモ
4. ユーザーストーリー3追加 → 独立テスト → デプロイ/デモ
5. 各ストーリーは前のストーリーを壊すことなく価値を追加

### 並行チーム戦略

複数の開発者がいる場合：

1. チームでセットアップ + 基盤を一緒に完了
2. 基盤が完了したら：
   - 開発者A: ユーザーストーリー1
   - 開発者B: ユーザーストーリー2
   - 開発者C: ユーザーストーリー3
3. ストーリーを完了し、独立して統合

---

## 注意点

- [P]タスク = 異なるファイル、依存関係なし
- [Story]ラベルはタスクを特定のユーザーストーリーにマッピング（追跡可能性のため）
- 各ユーザーストーリーは独立して完了・テスト可能であるべき
- 実装前にテストが失敗することを確認
- 各タスクまたは論理的なグループの後にコミット
- どのチェックポイントでも停止してストーリーを独立して検証可能
- 避けるべきこと: あいまいなタスク、同じファイルの競合、独立性を壊す複数のストーリー間の依存関係
