# 実装計画: トレーニングメニュー登録画面とトレーニング記録登録画面

**ブランチ**: `1-training-menu-record-form` | **作成日**: 2025-11-07 | **仕様書**: spec.md

## 技術的コンテキスト

- フロントエンド: Next.js, TypeScript, React
- UIフレームワーク: Pure.css
- バックエンド: Supabase（Postgres互換）
- バリデーション: フロント・バック両方で実施
- デプロイ: Netlify

## 画面設計

### トレーニングメニュー登録画面
| 項目         | 種類     | 必須 | 制約           | 備考           |
|--------------|----------|------|----------------|----------------|
| メニュー名   | text     | ○    | 最大20文字/重複禁止 | プレースホルダー: 例「スクワット」 |
| 登録ボタン   | button   | -    | -              |                |
| キャンセル   | button   | -    | -              | 一覧に戻る     |
| エラー表示   | message  | -    | -              | バリデーション結果を表示 |

### トレーニング記録登録画面
| 項目         | 種類     | 必須 | 制約           | 備考           |
|--------------|----------|------|----------------|----------------|
| メニュー選択 | select   | ○    | 有効メニューのみ |                |
| 日付         | date     | ○    | 当日固定 | YYYY-MM-DD形式 |
| 回数         | number   | ○    | 1以上の整数     | 人間の直接編集不可 |
| ログ表示         | string   | ○    | 当日実施済みのメニューと回数を表示する | 人間の直接編集不可 |
| タイマー         | number   | -    | 0以上の数     |                |
| スタートボタン   | button   | -    | -              | タイマーを0にして起動     |
| ストップボタン   | button   | -    | -              | タイマーを停止、初期状態で不活性化     |
| エラー表示   | message  | -    | -              | バリデーション結果を表示 |

## バリデーション・エラー処理
- メニュー名: 必須、最大20文字、重複禁止
- メニュー選択: 必須
- 回数: 1以上の整数（自動カウント、初期値0）
- 入力エラー時は即座に画面上にメッセージ表示
- サーバ側でも同様のバリデーションを実施

## 遷移・操作フロー
1. 初期表示時、回数は0、タイマーは停止状態、ストップボタンは非活性、既に登録済みのログを取得する
2. スタートボタン押下時:
   - 回数を1増やす
   - タイマー起動（0秒から開始）
   - メニュー選択を非活性化
   - スタートボタンを非活性化
   - ストップボタンを活性化
3. ストップボタン押下時:
   - タイマーを停止
   - メニュー選択を活性化
   - スタートボタンを活性化
   - ストップボタンを非活性化
4. メニュー選択変更時:
   - 回数が1以上の場合、現在のメニュー名・回数・タイマー値をログ表示に追加
   - サーバへ記録を自動保存（trainingMenuId, count, trainingAt=当日）
   - すでに同一メニュー同一日にログがある場合は既存記録の回数を加算する
   - 回数を0にリセット
   - タイマーを0にリセット
5. エラー時は画面上に分かりやすいメッセージ表示

## テスト・運用
- ユニットテスト: バリデーション・画面操作
- 統合テスト: API連携・登録/一覧反映
- E2Eテスト: ユーザー操作シナリオ
- CI: GitHub Actionsで自動テスト

## 依存関係・前提
- メニュー・記録の一覧表示APIが利用可能であること
- Supabaseのテーブル設計（training_menus, training_records）が事前に構築済み
- 認証は不要（内部利用前提）

## パフォーマンス・運用
- 登録操作は3秒以内に完了すること（spec.mdと整合）
- バリデーション・エラー表示は即時
- 障害時はエラーログを外部サービスに送信

---
